<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendrier Cliquable avec Textes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin: 20px;
        }
        .day {
            border: 1px solid #ccc;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .day:hover {
            background-color: #f0f0f0;
        }
        .selected {
            background-color: #007BFF;
            color: white;
        }
    </style>
</head>
<body>

    <h1>Calendrier Cliquable</h1>
    <div id="calendar"></div>
    <p id="selectedText"></p>

    <script>
        const sheetId = '1Y4zpeQJgkalrj32uYIF613sT-Nox5SHzXCduXCFEFTw'; // ID de ta feuille
        const apiKey = '1i9L8f83fnMzIFUVoTJlPtGbylm3Lf8Md7Ph7LkC74nA'; // Ta clé API
        const range = 'Feuille1!A:B'; // Modifie si nécessaire

        let events = {}; // Objet pour stocker les événements

        async function fetchEvents() {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`);
            const data = await response.json();

            if (data.values && data.values.length > 0) {
                // Remplir l'objet events avec les données de la feuille
                for (let i = 1; i < data.values.length; i++) {
                    const [date, text] = data.values[i];
                    events[date] = text; // Utiliser la date comme clé
                }
            } else {
                alert('Aucune donnée trouvée.');
            }
        }

        function createCalendar(year, month) {
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = ''; // Vider le calendrier avant de le remplir

            const date = new Date(year, month);
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();

            // Ajouter les jours de la semaine
            const daysOfWeek = ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'];
            daysOfWeek.forEach(day => {
                const div = document.createElement('div');
                div.className = 'day';
                div.textContent = day;
                calendar.appendChild(div);
            });

            // Ajouter des espaces pour les jours précédents
            for (let i = 0; i < firstDay; i++) {
                const div = document.createElement('div');
                calendar.appendChild(div);
            }

            // Ajouter les jours du mois
            for (let i = 1; i <= lastDate; i++) {
                const div = document.createElement('div');
                div.className = 'day';
                div.textContent = i;
                div.onclick = () => selectDate(year, month, i);
                calendar.appendChild(div);
            }
        }

        function selectDate(year, month, day) {
            const selectedDate = `${day}/${month + 1}/${year}`; // Format JJ/MM/AAAA
            const text = events[selectedDate] || 'Aucun texte associé pour cette date.'; // Récupérer le texte associé
            document.getElementById('selectedText').textContent = text;
            highlightSelectedDay(day);
        }

        function highlightSelectedDay(day) {
            const days = document.querySelectorAll('.day');
            days.forEach((d, index) => {
                if (parseInt(d.textContent) === day) {
                    d.classList.add('selected');
                } else {
                    d.classList.remove('selected');
                }
            });
        }

        // Récupérer les événements et créer le calendrier pour le mois actuel
        fetchEvents().then(() => {
            const today = new Date();
            createCalendar(today.getFullYear(), today.getMonth());
        });
    </script>

</body>
</html>
